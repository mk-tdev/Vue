<script>
  function getTableHeaders(el) {
    var tableHeads = $(el).find('tbody tr:first-child td');
    var headTexts = _.map(tableHeads, function (element, key) {
      return (element.textContent || element.innerText).replace(/\r?\n|\r/g, "").trim();
    })
    return headTexts;
  }

  function attachEvents() {
    $(document).on("click", ".mobile_tabs li", function (event) {
      event.preventDefault();
      var target = event.target;
      var pos = $(this).index();

      setTabs(pos, $('table'));

      $(this).parent().find('li').removeClass('active');
      $(this).addClass('active');
    });
  }

  function setTabs(pos, tableElem) {
    $('.mobile-tab-container').remove();
    var mobileTabContainer = $('<div class="mobile-tab-container"></div>');
    var trows = $(tableElem).find('tr:not(:eq(0))');

    $(trows).each(function (index) {
      var td = $(this).find('td:eq(' + pos + ')');
      mobileTabContainer.append($(td).clone());
    })

    $('ul.mobile_tabs').after(mobileTabContainer);
  }

  function createTabs(tableElem) {
    var headers = getTableHeaders(tableElem)
    var filteredHeaders = _.filter(headers, function (val) { return val !== "" });

    var container = $('<ul class="mobile_tabs" />');

    for (let index = 0; index < filteredHeaders.length; index++) {
      var item = (index === 0) ?
        ('<li data-table-col=' + index + ' class="active">' + filteredHeaders[index] + '</li>') :
        ('<li data-table-col=' + index + '>' + filteredHeaders[index] + '</li>');

      container.append(item);
    }

    tableElem.parent().prepend(container);
  }

  function tabView(tableElem) {
    createTabs(tableElem);
    setTabs(0, tableElem);
  }

  $(document).ready(function () {
    window.matchMedia('(max-width: 767px)').addListener(tableLoad);
    tableLoad(window.matchMedia('(max-width: 767px)'));
  });

  function tableLoad(mq) {
    if (mq.matches) {
      $('table').hide();
      var tableElem = $('table');
      tabView(tableElem);

      attachEvents();
    } else {
      $('table').show();
      $('.mobile-tab-container').remove();
      $('.mobile_tabs').remove();
    }
  }
</script>

<style>
  .table-responsive,
  table>tbody>tr>td {
    border: none !important;
  }

  .mobile_tabs {
    display: flex;
    margin: 20px 15px;
    align-items: center;
    justify-content: space-evenly;
    flex-direction: row;
    border-bottom: 1px solid #ddd;
    flex-wrap: wrap;
    padding: 0 10px;
  }

  .mobile_tabs li {
    list-style: none;
    cursor: pointer;
    padding: 10px;
    border-bottom: 4px solid #f9f9f9;
    margin: 0 5px;
    font-weight: 600;
  }

  .mobile_tabs li:hover {
    background-color: #eee;
  }

  .mobile_tabs li.active {
    border-bottom: blue 4px solid;
  }

  .mobile-tab-rows {
    display: flex;
    justify-content: space-between;
    padding: 0 10px;
  }

  .mobile-tab-container {
    display: flex;
    flex-direction: column;
    margin: 20px 15px;
  }

  .mobile-tab-container td {
    display: flex;
    justify-content: space-between;
    flex-direction: row-reverse;
    width: 100%;
  }
</style>